{
  "last_node_id": 129,
  "last_link_id": 262,
  "nodes": [
    {
      "id": 108,
      "type": "Conv_layer",
      "pos": [
        -1280,
        650
      ],
      "size": {
        "0": 315,
        "1": 198
      },
      "flags": {},
      "order": 3,
      "mode": 0,
      "inputs": [
        {
          "name": "layer",
          "type": "LAYER",
          "link": 232
        },
        {
          "name": "res",
          "type": "RES",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "LAYER",
          "type": "LAYER",
          "links": [
            234
          ],
          "shape": 3,
          "slot_index": 0
        },
        {
          "name": "res",
          "type": "RES",
          "links": null,
          "shape": 3,
          "slot_index": 1
        }
      ],
      "properties": {
        "Node name for S&R": "Conv_layer"
      },
      "widgets_values": [
        512,
        640,
        3,
        1,
        1,
        "add"
      ]
    },
    {
      "id": 88,
      "type": "easy showAnything",
      "pos": [
        -22,
        1301
      ],
      "size": {
        "0": 716.8633422851562,
        "1": 539.4473266601562
      },
      "flags": {},
      "order": 21,
      "mode": 0,
      "inputs": [
        {
          "name": "anything",
          "type": "*",
          "link": 224
        }
      ],
      "properties": {
        "Node name for S&R": "easy showAnything"
      },
      "widgets_values": [
        "net(\n  (layer): ModuleList(\n    (0): vgg_16(\n      (vgg16): VGG(\n        (features): Sequential(\n          (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n          (1): ReLU(inplace=True)\n          (2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n          (3): ReLU(inplace=True)\n          (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n          (5): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n          (6): ReLU(inplace=True)\n          (7): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n          (8): ReLU(inplace=True)\n          (9): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n          (10): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n          (11): ReLU(inplace=True)\n          (12): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n          (13): ReLU(inplace=True)\n          (14): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n          (15): ReLU(inplace=True)\n          (16): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n          (17): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n          (18): ReLU(inplace=True)\n          (19): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n          (20): ReLU(inplace=True)\n          (21): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n          (22): ReLU(inplace=True)\n          (23): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n          (24): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n          (25): ReLU(inplace=True)\n          (26): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n          (27): ReLU(inplace=True)\n          (28): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n          (29): ReLU(inplace=True)\n          (30): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n        )\n        (avgpool): AdaptiveAvgPool2d(output_size=(7, 7))\n        (classifier): Sequential(\n          (0): Linear(in_features=25088, out_features=4096, bias=True)\n          (1): ReLU(inplace=True)\n          (2): Dropout(p=0.5, inplace=False)\n          (3): Linear(in_features=4096, out_features=4096, bias=True)\n          (4): ReLU(inplace=True)\n          (5): Dropout(p=0.5, inplace=False)\n          (6): Linear(in_features=4096, out_features=1000, bias=True)\n        )\n      )\n    )\n    (1): Conv2d(512, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n    (2): ReLU()\n    (3): Conv2d(640, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n    (4): ReLU()\n    (5): Conv2d(320, 250, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n    (6): AdaptiveAvgPool2d(output_size=[5, 5])\n    (7): view()\n    (8): Linear(in_features=6250, out_features=1280, bias=True)\n    (9): ReLU()\n    (10): Linear(in_features=1280, out_features=640, bias=True)\n    (11): ReLU()\n    (12): Linear(in_features=640, out_features=64, bias=True)\n    (13): ReLU()\n    (14): Linear(in_features=64, out_features=2, bias=True)\n    (15): Softmax(dim=-1)\n  )\n  (MSE): MSELoss()\n  (CEB): CrossEntropyLoss()\n  (BCE): BCELoss()\n)"
      ]
    },
    {
      "id": 105,
      "type": "pre_train_layer",
      "pos": [
        -1280,
        450
      ],
      "size": {
        "0": 315,
        "1": 150
      },
      "flags": {},
      "order": 0,
      "mode": 0,
      "inputs": [
        {
          "name": "layer",
          "type": "LAYER",
          "link": null
        },
        {
          "name": "res",
          "type": "RES",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "LAYER",
          "type": "LAYER",
          "links": [
            232
          ],
          "shape": 3,
          "slot_index": 0
        },
        {
          "name": "res",
          "type": "RES",
          "links": null,
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "pre_train_layer"
      },
      "widgets_values": [
        "vgg_16",
        true,
        true,
        "add"
      ]
    },
    {
      "id": 109,
      "type": "activation_function",
      "pos": [
        -1280,
        920
      ],
      "size": {
        "0": 315,
        "1": 102
      },
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [
        {
          "name": "layer",
          "type": "LAYER",
          "link": 234
        },
        {
          "name": "res",
          "type": "RES",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "LAYER",
          "type": "LAYER",
          "links": [
            235
          ],
          "shape": 3,
          "slot_index": 0
        },
        {
          "name": "res",
          "type": "RES",
          "links": null,
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "activation_function"
      },
      "widgets_values": [
        "ReLU",
        "add"
      ]
    },
    {
      "id": 117,
      "type": "activation_function",
      "pos": [
        -846,
        640
      ],
      "size": {
        "0": 315,
        "1": 102
      },
      "flags": {},
      "order": 12,
      "mode": 0,
      "inputs": [
        {
          "name": "layer",
          "type": "LAYER",
          "link": 244
        },
        {
          "name": "res",
          "type": "RES",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "LAYER",
          "type": "LAYER",
          "links": [
            245
          ],
          "shape": 3,
          "slot_index": 0
        },
        {
          "name": "res",
          "type": "RES",
          "links": null,
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "activation_function"
      },
      "widgets_values": [
        "ReLU",
        "add"
      ]
    },
    {
      "id": 119,
      "type": "activation_function",
      "pos": [
        -847.8440609273567,
        986.2060444176569
      ],
      "size": {
        "0": 315,
        "1": 102
      },
      "flags": {},
      "order": 14,
      "mode": 0,
      "inputs": [
        {
          "name": "layer",
          "type": "LAYER",
          "link": 246
        },
        {
          "name": "res",
          "type": "RES",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "LAYER",
          "type": "LAYER",
          "links": [
            247
          ],
          "shape": 3,
          "slot_index": 0
        },
        {
          "name": "res",
          "type": "RES",
          "links": null,
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "activation_function"
      },
      "widgets_values": [
        "ReLU",
        "add"
      ]
    },
    {
      "id": 121,
      "type": "activation_function",
      "pos": [
        -845.0844106026493,
        1325.6430343566612
      ],
      "size": {
        "0": 315,
        "1": 102
      },
      "flags": {},
      "order": 16,
      "mode": 0,
      "inputs": [
        {
          "name": "layer",
          "type": "LAYER",
          "link": 248
        },
        {
          "name": "res",
          "type": "RES",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "LAYER",
          "type": "LAYER",
          "links": [
            249
          ],
          "shape": 3,
          "slot_index": 0
        },
        {
          "name": "res",
          "type": "RES",
          "links": null,
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "activation_function"
      },
      "widgets_values": [
        "ReLU",
        "add"
      ]
    },
    {
      "id": 123,
      "type": "activation_function",
      "pos": [
        -850,
        1670
      ],
      "size": {
        "0": 315,
        "1": 102
      },
      "flags": {},
      "order": 18,
      "mode": 0,
      "inputs": [
        {
          "name": "layer",
          "type": "LAYER",
          "link": 250
        },
        {
          "name": "res",
          "type": "RES",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "LAYER",
          "type": "LAYER",
          "links": [
            251
          ],
          "shape": 3,
          "slot_index": 0
        },
        {
          "name": "res",
          "type": "RES",
          "links": null,
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "activation_function"
      },
      "widgets_values": [
        "Softmax",
        "add"
      ]
    },
    {
      "id": 116,
      "type": "linear_layer",
      "pos": [
        -844,
        457
      ],
      "size": {
        "0": 315,
        "1": 126
      },
      "flags": {},
      "order": 11,
      "mode": 0,
      "inputs": [
        {
          "name": "layer",
          "type": "LAYER",
          "link": 243
        },
        {
          "name": "res",
          "type": "RES",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "LAYER",
          "type": "LAYER",
          "links": [
            244
          ],
          "shape": 3,
          "slot_index": 0
        },
        {
          "name": "res",
          "type": "RES",
          "links": null,
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "linear_layer"
      },
      "widgets_values": [
        6250,
        1280,
        "add"
      ]
    },
    {
      "id": 118,
      "type": "linear_layer",
      "pos": [
        -846,
        803
      ],
      "size": {
        "0": 315,
        "1": 126
      },
      "flags": {},
      "order": 13,
      "mode": 0,
      "inputs": [
        {
          "name": "layer",
          "type": "LAYER",
          "link": 245
        },
        {
          "name": "res",
          "type": "RES",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "LAYER",
          "type": "LAYER",
          "links": [
            246
          ],
          "shape": 3,
          "slot_index": 0
        },
        {
          "name": "res",
          "type": "RES",
          "links": null,
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "linear_layer"
      },
      "widgets_values": [
        1280,
        640,
        "add"
      ]
    },
    {
      "id": 120,
      "type": "linear_layer",
      "pos": [
        -843,
        1143
      ],
      "size": {
        "0": 315,
        "1": 126
      },
      "flags": {},
      "order": 15,
      "mode": 0,
      "inputs": [
        {
          "name": "layer",
          "type": "LAYER",
          "link": 247
        },
        {
          "name": "res",
          "type": "RES",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "LAYER",
          "type": "LAYER",
          "links": [
            248
          ],
          "shape": 3,
          "slot_index": 0
        },
        {
          "name": "res",
          "type": "RES",
          "links": null,
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "linear_layer"
      },
      "widgets_values": [
        640,
        64,
        "add"
      ]
    },
    {
      "id": 122,
      "type": "linear_layer",
      "pos": [
        -850,
        1490
      ],
      "size": {
        "0": 315,
        "1": 126
      },
      "flags": {},
      "order": 17,
      "mode": 0,
      "inputs": [
        {
          "name": "layer",
          "type": "LAYER",
          "link": 249
        },
        {
          "name": "res",
          "type": "RES",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "LAYER",
          "type": "LAYER",
          "links": [
            250
          ],
          "shape": 3,
          "slot_index": 0
        },
        {
          "name": "res",
          "type": "RES",
          "links": null,
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "linear_layer"
      },
      "widgets_values": [
        64,
        2,
        "add"
      ]
    },
    {
      "id": 114,
      "type": "Conv_layer",
      "pos": [
        -1283,
        1090
      ],
      "size": {
        "0": 315,
        "1": 198
      },
      "flags": {},
      "order": 6,
      "mode": 0,
      "inputs": [
        {
          "name": "layer",
          "type": "LAYER",
          "link": 235
        },
        {
          "name": "res",
          "type": "RES",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "LAYER",
          "type": "LAYER",
          "links": [
            236
          ],
          "shape": 3,
          "slot_index": 0
        },
        {
          "name": "res",
          "type": "RES",
          "links": null,
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "Conv_layer"
      },
      "widgets_values": [
        640,
        320,
        3,
        1,
        1,
        "add"
      ]
    },
    {
      "id": 111,
      "type": "activation_function",
      "pos": [
        -1278,
        1338
      ],
      "size": {
        "0": 315,
        "1": 102
      },
      "flags": {},
      "order": 7,
      "mode": 0,
      "inputs": [
        {
          "name": "layer",
          "type": "LAYER",
          "link": 236
        },
        {
          "name": "res",
          "type": "RES",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "LAYER",
          "type": "LAYER",
          "links": [
            237
          ],
          "shape": 3,
          "slot_index": 0
        },
        {
          "name": "res",
          "type": "RES",
          "links": null,
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "activation_function"
      },
      "widgets_values": [
        "ReLU",
        "add"
      ]
    },
    {
      "id": 115,
      "type": "Conv_layer",
      "pos": [
        -1275,
        1488
      ],
      "size": {
        "0": 315,
        "1": 198
      },
      "flags": {},
      "order": 8,
      "mode": 0,
      "inputs": [
        {
          "name": "layer",
          "type": "LAYER",
          "link": 237
        },
        {
          "name": "res",
          "type": "RES",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "LAYER",
          "type": "LAYER",
          "links": [
            238
          ],
          "shape": 3,
          "slot_index": 0
        },
        {
          "name": "res",
          "type": "RES",
          "links": null,
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "Conv_layer"
      },
      "widgets_values": [
        320,
        250,
        3,
        1,
        1,
        "add"
      ]
    },
    {
      "id": 106,
      "type": "pooling_layer",
      "pos": [
        -1273,
        1739
      ],
      "size": {
        "0": 315,
        "1": 126
      },
      "flags": {},
      "order": 9,
      "mode": 0,
      "inputs": [
        {
          "name": "layer",
          "type": "LAYER",
          "link": 238
        },
        {
          "name": "res",
          "type": "RES",
          "link": null,
          "slot_index": 1
        }
      ],
      "outputs": [
        {
          "name": "LAYER",
          "type": "LAYER",
          "links": [
            229
          ],
          "shape": 3,
          "slot_index": 0
        },
        {
          "name": "res",
          "type": "RES",
          "links": null,
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "pooling_layer"
      },
      "widgets_values": [
        "adaptive_avgpool",
        "[5,5]",
        "add"
      ]
    },
    {
      "id": 107,
      "type": "view_layer",
      "pos": [
        -1270,
        1920
      ],
      "size": {
        "0": 315,
        "1": 102
      },
      "flags": {},
      "order": 10,
      "mode": 0,
      "inputs": [
        {
          "name": "layer",
          "type": "LAYER",
          "link": 229
        },
        {
          "name": "res",
          "type": "RES",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "LAYER",
          "type": "LAYER",
          "links": [
            243
          ],
          "shape": 3,
          "slot_index": 0
        },
        {
          "name": "res",
          "type": "RES",
          "links": null,
          "shape": 3,
          "slot_index": 1
        }
      ],
      "properties": {
        "Node name for S&R": "view_layer"
      },
      "widgets_values": [
        -1,
        "add"
      ]
    },
    {
      "id": 48,
      "type": "create_model",
      "pos": [
        -233,
        1177
      ],
      "size": {
        "0": 210,
        "1": 26
      },
      "flags": {},
      "order": 19,
      "mode": 0,
      "inputs": [
        {
          "name": "layer",
          "type": "LAYER",
          "link": 251
        }
      ],
      "outputs": [
        {
          "name": "model",
          "type": "MODELS_CLASS",
          "links": [
            118,
            224,
            256
          ],
          "shape": 3,
          "slot_index": 0
        }
      ],
      "properties": {
        "Node name for S&R": "create_model"
      }
    },
    {
      "id": 74,
      "type": "forward_test",
      "pos": [
        134,
        1013
      ],
      "size": {
        "0": 315,
        "1": 102
      },
      "flags": {},
      "order": 20,
      "mode": 0,
      "inputs": [
        {
          "name": "tensor",
          "type": "TENSOR",
          "link": 257
        },
        {
          "name": "model",
          "type": "MODELS_CLASS",
          "link": 118
        }
      ],
      "outputs": [
        {
          "name": "tensor",
          "type": "TENSOR",
          "links": [],
          "shape": 3,
          "slot_index": 0
        },
        {
          "name": "layer tensor",
          "type": "TENSOR",
          "links": [],
          "shape": 3,
          "slot_index": 1
        }
      ],
      "properties": {
        "Node name for S&R": "forward_test"
      },
      "widgets_values": [
        false,
        true
      ]
    },
    {
      "id": 75,
      "type": "create_intput",
      "pos": [
        -363,
        1020
      ],
      "size": {
        "0": 315,
        "1": 58
      },
      "flags": {},
      "order": 1,
      "mode": 0,
      "outputs": [
        {
          "name": "tensor",
          "type": "TENSOR",
          "links": [
            257
          ],
          "shape": 3,
          "slot_index": 0
        }
      ],
      "properties": {
        "Node name for S&R": "create_intput"
      },
      "widgets_values": [
        "[1,3,64,512]"
      ]
    },
    {
      "id": 125,
      "type": "create_training_task",
      "pos": [
        79,
        715
      ],
      "size": {
        "0": 315,
        "1": 146
      },
      "flags": {},
      "order": 22,
      "mode": 4,
      "inputs": [
        {
          "name": "train_dataset",
          "type": "DATESET",
          "link": null
        },
        {
          "name": "model",
          "type": "MODELS_CLASS",
          "link": 256
        },
        {
          "name": "val_dataset",
          "type": "DATESET",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "model",
          "type": "MODELS_CLASS",
          "links": null,
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "create_training_task"
      },
      "widgets_values": [
        "gpu",
        100,
        100
      ]
    },
    {
      "id": 129,
      "type": "create_dataset",
      "pos": [
        -368,
        616
      ],
      "size": {
        "0": 315,
        "1": 330
      },
      "flags": {},
      "order": 2,
      "mode": 0,
      "outputs": [
        {
          "name": "train dataset",
          "type": "DATESET",
          "links": null,
          "shape": 3
        },
        {
          "name": "val dataset",
          "type": "DATESET",
          "links": null,
          "shape": 3
        },
        {
          "name": "test data",
          "type": "TENSOR",
          "links": null,
          "shape": 3
        },
        {
          "name": "test label",
          "type": "TENSOR",
          "links": null,
          "shape": 3
        },
        {
          "name": "image show",
          "type": "IMAGE",
          "links": [
            262
          ],
          "shape": 3,
          "slot_index": 4
        }
      ],
      "properties": {
        "Node name for S&R": "create_dataset"
      },
      "widgets_values": [
        true,
        true,
        "D:/ComfyUI_windows_portable_nvidia_cu121_or_cpu/ComfyUI_windows_portable/ComfyUI/custom_nodes/comfyui_train/dataset/train",
        true,
        1,
        "[512, 512]",
        "[0.485, 0.456, 0.406]",
        "[0.229, 0.224, 0.225]",
        "D:/ComfyUI_windows_portable_nvidia_cu121_or_cpu/ComfyUI_windows_portable/ComfyUI/custom_nodes/comfyui_train/dataset/val"
      ]
    },
    {
      "id": 126,
      "type": "PreviewImage",
      "pos": [
        124,
        634
      ],
      "size": {
        "0": 210,
        "1": 246
      },
      "flags": {},
      "order": 4,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 262
        }
      ],
      "properties": {
        "Node name for S&R": "PreviewImage"
      }
    }
  ],
  "links": [
    [
      118,
      48,
      0,
      74,
      1,
      "MODELS_CLASS"
    ],
    [
      224,
      48,
      0,
      88,
      0,
      "*"
    ],
    [
      229,
      106,
      0,
      107,
      0,
      "LAYER"
    ],
    [
      232,
      105,
      0,
      108,
      0,
      "LAYER"
    ],
    [
      234,
      108,
      0,
      109,
      0,
      "LAYER"
    ],
    [
      235,
      109,
      0,
      114,
      0,
      "LAYER"
    ],
    [
      236,
      114,
      0,
      111,
      0,
      "LAYER"
    ],
    [
      237,
      111,
      0,
      115,
      0,
      "LAYER"
    ],
    [
      238,
      115,
      0,
      106,
      0,
      "LAYER"
    ],
    [
      243,
      107,
      0,
      116,
      0,
      "LAYER"
    ],
    [
      244,
      116,
      0,
      117,
      0,
      "LAYER"
    ],
    [
      245,
      117,
      0,
      118,
      0,
      "LAYER"
    ],
    [
      246,
      118,
      0,
      119,
      0,
      "LAYER"
    ],
    [
      247,
      119,
      0,
      120,
      0,
      "LAYER"
    ],
    [
      248,
      120,
      0,
      121,
      0,
      "LAYER"
    ],
    [
      249,
      121,
      0,
      122,
      0,
      "LAYER"
    ],
    [
      250,
      122,
      0,
      123,
      0,
      "LAYER"
    ],
    [
      251,
      123,
      0,
      48,
      0,
      "LAYER"
    ],
    [
      256,
      48,
      0,
      125,
      1,
      "MODELS_CLASS"
    ],
    [
      257,
      75,
      0,
      74,
      0,
      "TENSOR"
    ],
    [
      262,
      129,
      4,
      126,
      0,
      "IMAGE"
    ]
  ],
  "groups": [],
  "config": {},
  "extra": {
    "ds": {
      "scale": 1.0610764609500007,
      "offset": [
        438.9315957256337,
        -311.5931797864379
      ]
    }
  },
  "version": 0.4
}